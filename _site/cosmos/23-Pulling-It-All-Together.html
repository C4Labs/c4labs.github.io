<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
	

  <title>Pulling It All Together</title>
  <meta name="description" content="This chapter weaves the components we’ve created into a nice, unified app and user experience.">
  <meta property="og:image" content="http://www.c4ios.com/images/banner.jpg">
  <meta property="og:url"   content="http://c4ios.com" />
  <meta property="og:title" content="Pulling It All Together"/>
  <meta name="og:description" content="This chapter weaves the components we’ve created into a nice, unified app and user experience.">
  <meta property="og:type"  content="website"/>
  <meta property="og:site_name"  content="C4"/>

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@c4framework">
  <meta name="twitter:creator" content="@c4framework">
  <meta name="twitter:title" content="Pulling It All Together">
  <meta name="twitter:description" content="This chapter weaves the components we’ve created into a nice, unified app and user experience.">
  <meta name="twitter:image" content="http://www.c4ios.com/images/banner.jpg">


  <link rel="stylesheet" type="text/css" href="/css/style.css" >
  <link rel="stylesheet" href="/css/syntax.css">
  <link href='https://fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'>

  <link rel="canonical" href="www.c4ios.com/cosmos/23-Pulling-It-All-Together">
  <link rel="alternate" type="application/rss+xml" title="C4 website" href="www.c4ios.com/feed.xml">
</head>

    <body class="pulling-it-all-together" data-spy="scroll" data-target="#toc">

    <header>
  <nav class="navbar navbar-default" role="navigation"> 
    <div class="navbar-header container">
      <div class="row"> 
        <div class="col-xs-12 col-sm-12 col-md-12 navlist">
          <a class="navbar-brand" href="/">
            <span><img src="/images/c4logo.png"></span>
          </a>
          <ul class="nav navbar-nav navbar-left">
            <li><a href="/install" >Install</a></li>
            <li><a href="/tutorials" >Tutorials</a></li>
            <li><a href="/cosmos" class='active'>COSMOS</a></li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li><a href="/examples" >Examples</a></li>
            <li><a href="http://discourse.c4ios.com">Forums</a></li>
            <li><a href="http://cocoadocs.org/docsets/C4/1.1.0/">Documentation</a></li>
          </ul>
        </div>
      </div>  
    </div>        
  </nav>      
</header>

    <div class="container content pulling-it-all-together" >
      <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 breadcrumb">
          <h1><a href="/tutorials">Tutorials</a><div class="bread-caret">></div><a href="/cosmos">COSMOS</a><div class="bread-caret">></div>Pulling It All Together</h1>
        </div>
      </div>

      <div class="row">
        <div class="col-xs-3 col-sm-3 col-md-3">
          <span class="img large">
            <img src="/images/cosmos/1/poster.png" />
          </span>
          <p class="title">Chapter 23<br /><span class="lighter">Pulling It All Together</span></p>
          <p>Tags<br /><a href="/tag/getting started">getting started</a>, <a href="/tag/basics">basics</a>, <a href="/tag/introduction">introduction</a>, <a href="/tag/easy">easy</a>, <a href="/tag/c4">c4</a>, </p>
          <p>Estimated Time<br /><span class="lighter"></span></p>

          <hr />

          <div id="toc"></div>
        </div>

        <div class="col-xs-9 col-sm-9 col-md-9 tutorial">
          <p>This chapter weaves the components we’ve created into a nice, unified app and user experience.</p>

<p>To recap, we have created the following things:</p>

<ol>
  <li>An infinite scrollview subclass of UIScrollview</li>
  <li>An Astrological Sign Provider that stores data about the various signs</li>
  <li>A Stars background that has 8 different layers of scrolling content</li>
  <li>A great looking radial menu with complex animations and a nice interaction mechanism that uses long presses</li>
  <li>An info panel that links to the C4 site</li>
</ol>

<p>Now, to bring COSMOS to life, we need to address the following:</p>

<ol>
  <li>Add the menu, background and info panel to the app</li>
  <li>Link the menu to the background via a selection action and the background’s <code class="highlighter-rouge">goTo</code> method</li>
  <li>Link the menu to the info panel via an info action</li>
  <li>Add a couple of ambient audio files that will provide background music for the app</li>
</ol>

<p>So, let’s get to it.</p>

<h2 id="the-workspace">The WorkSpace</h2>

<p>Most of the work we’re going to be doing is centered around the <code class="highlighter-rouge">WorkSpace</code>. Although we’ll have to tweak a couple of classes, it’s the WorkSpace’s <code class="highlighter-rouge">setup()</code> where we will be creating objects and linking them together.</p>

<p>First, if you’ve been using the WorkSpace to launch or test any of the work you’ve been doing, now’s the time to clean it up and change the background color to <code class="highlighter-rouge">COSMOSbkgd</code>.</p>

<p>It should look like this:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10</pre></td><td class="code"><pre><span class="k">let</span> <span class="nv">COSMOSprpl</span> <span class="o">=</span> <span class="kt">Color</span><span class="p">(</span><span class="nv">red</span><span class="p">:</span><span class="mf">0.565</span><span class="p">,</span> <span class="nv">green</span><span class="p">:</span> <span class="mf">0.075</span><span class="p">,</span> <span class="nv">blue</span><span class="p">:</span> <span class="mf">0.996</span><span class="p">,</span> <span class="nv">alpha</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">COSMOSblue</span> <span class="o">=</span> <span class="kt">Color</span><span class="p">(</span><span class="nv">red</span><span class="p">:</span> <span class="mf">0.094</span><span class="p">,</span> <span class="nv">green</span><span class="p">:</span> <span class="mf">0.271</span><span class="p">,</span> <span class="nv">blue</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="nv">alpha</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">COSMOSbkgd</span> <span class="o">=</span> <span class="kt">Color</span><span class="p">(</span><span class="nv">red</span><span class="p">:</span> <span class="mf">0.078</span><span class="p">,</span> <span class="nv">green</span><span class="p">:</span> <span class="mf">0.118</span><span class="p">,</span> <span class="nv">blue</span><span class="p">:</span> <span class="mf">0.306</span><span class="p">,</span> <span class="nv">alpha</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">)</span>

<span class="kd">class</span> <span class="kt">WorkSpace</span><span class="p">:</span> <span class="kt">CanvasController</span> <span class="p">{</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">canvas</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="kt">COSMOSbkgd</span>
    <span class="p">}</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h2 id="stars">Stars</h2>

<p>Adding the stars background is dead-easy, just create a copy of <code class="highlighter-rouge">Stars</code> and add it to the canvas, like this:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7</pre></td><td class="code"><pre><span class="kd">class</span> <span class="kt">WorkSpace</span><span class="p">:</span> <span class="kt">CanvasController</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">stars</span> <span class="o">=</span> <span class="kt">Stars</span><span class="p">()</span>
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">canvas</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="kt">COSMOSbkgd</span>
        <span class="n">canvas</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="n">stars</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>  
    <span class="p">}</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Done. Run it and you’ll be able to scroll through the COSMOS.</p>

<h2 id="menu">Menu</h2>

<p>Adding the menu is pretty easy too. Just follow the same steps as above, and add the menu after you’ve added the background.</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10</pre></td><td class="code"><pre><span class="kd">class</span> <span class="kt">WorkSpace</span><span class="p">:</span> <span class="kt">CanvasController</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">stars</span> <span class="o">=</span> <span class="kt">Stars</span><span class="p">()</span>
    <span class="k">let</span> <span class="nv">menu</span> <span class="o">=</span> <span class="kt">Menu</span><span class="p">()</span>
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">canvas</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="kt">COSMOSbkgd</span>
        <span class="n">canvas</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="n">stars</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>  
        <span class="n">menu</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">center</span>  
        <span class="n">canvas</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="n">menu</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span> 
    <span class="p">}</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h3 id="the-menus-frame-explained">The Menu’s Frame (Explained)</h3>

<p>We want the behaviour of the menu to be like this: The menu should open only when the user presses on it, i.e. not anywhere else on the screen. This is why we make the canvas small (i.e. 80x80). Since the frame is this small the interaction with the menu’s canvas is limited only to this 80x80 view.</p>

<p>Simple.</p>

<h2 id="info-panel">Info Panel</h2>

<p>This step’s a cinch. Create another variable for the info panel, then instantiate it in <code class="highlighter-rouge">setup()</code> and add it to the WorkSpace’s canvas after you’ve added the menu.</p>

<p>Then, go into <code class="highlighter-rouge">InfoPanel.swift</code> and add the following line to it’s <code class="highlighter-rouge">setup()</code>:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="k">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">opacity</span> <span class="o">=</span> <span class="mf">0.0</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<blockquote>
  <p>Since the opacity is <code class="highlighter-rouge">0.0</code> the canvas automatically will not receive touches, so adding it over top of the menu is okay at this point and will not prevent the user from touching the menu</p>
</blockquote>

<p>Your WorkSpace should look like this:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16</pre></td><td class="code"><pre><span class="kd">class</span> <span class="kt">WorkSpace</span><span class="p">:</span> <span class="kt">CanvasController</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">stars</span> <span class="o">=</span> <span class="kt">Stars</span><span class="p">()</span>
    <span class="k">let</span> <span class="nv">menu</span> <span class="o">=</span> <span class="kt">Menu</span><span class="p">()</span>
    <span class="k">let</span> <span class="nv">info</span> <span class="o">=</span> <span class="kt">InfoPanel</span><span class="p">()</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">canvas</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="kt">COSMOSbkgd</span>

        <span class="n">canvas</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="n">stars</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>

        <span class="n">menu</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">center</span>
        <span class="n">canvas</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="n">menu</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>

        <span class="n">canvas</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h2 id="connect-the-menu--background">Connect the Menu &amp; Background</h2>

<p>To connect the menu and background we’re going to use a nice little trick: we’ll add a special type of action to the menu and link that with the background’s <code class="highlighter-rouge">goTo()</code> method.</p>

<p>Go into <code class="highlighter-rouge">Menu.Swift</code> and at the very top of the file, above the class declaration, add the following line:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="kd">typealias</span> <span class="kt">SelectionAction</span> <span class="o">=</span> <span class="p">(</span><span class="nv">selection</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>This is a type alias through which we’ll be able to assign a method from another class. The selection action is essentially the action to which we want to send the menu’s current selection.</p>

<p>Create a variable to hold reference to a selection action:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="k">var</span> <span class="nv">selectionAction</span> <span class="p">:</span> <span class="kt">SelectionAction</span><span class="p">?</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Navigate down to <code class="highlighter-rouge">createGesture()</code> and in the <code class="highlighter-rouge">case .Cancelled:</code> block add the following:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre><span class="k">if</span> <span class="k">let</span> <span class="nv">sa</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">selectionAction</span>  <span class="k">where</span> <span class="k">self</span><span class="o">.</span><span class="n">menuSelector</span><span class="o">.</span><span class="n">currentSelection</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="p">{</span>
    <span class="nf">sa</span><span class="p">(</span><span class="nv">selection</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">menuSelector</span><span class="o">.</span><span class="n">currentSelection</span><span class="p">)</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<blockquote>
  <p>Since we sometimes set the current selection to -1, we need the additional <code class="highlighter-rouge">where</code> statement</p>
</blockquote>

<p>Remember this method from Chapter 14?:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14</pre></td><td class="code"><pre><span class="kd">func</span> <span class="nf">goto</span><span class="p">(</span><span class="nv">selection</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">target</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="kt">Double</span><span class="p">(</span><span class="n">gapBetweenSigns</span><span class="p">)</span> <span class="o">*</span> <span class="kt">Double</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>

    <span class="k">let</span> <span class="nv">anim</span> <span class="o">=</span> <span class="kt">ViewAnimation</span><span class="p">(</span><span class="nv">duration</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">)</span> <span class="p">{</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
        <span class="k">self</span><span class="o">.</span><span class="n">bigStars</span><span class="o">.</span><span class="n">contentOffset</span> <span class="o">=</span> <span class="kt">CGPoint</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="kt">CGFloat</span><span class="p">(</span><span class="n">target</span><span class="p">),</span><span class="nv">y</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">anim</span><span class="o">.</span><span class="n">curve</span> <span class="o">=</span> <span class="o">.</span><span class="kt">EaseOut</span>
    <span class="n">anim</span><span class="o">.</span><span class="n">addCompletionObserver</span> <span class="p">{</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
        <span class="k">self</span><span class="o">.</span><span class="n">signLines</span><span class="o">.</span><span class="nf">revealCurrentSignLines</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="n">anim</span><span class="o">.</span><span class="nf">animate</span><span class="p">()</span>
    
    <span class="n">signLines</span><span class="o">.</span><span class="n">currentIndex</span> <span class="o">=</span> <span class="n">selection</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>This method conforms to the same parameters as the <code class="highlighter-rouge">SelectionAction</code> type alias we just created. It also takes an integer and figures out a target and animates to that point in its scrollview.</p>

<p>Finally, go to your project’s WorkSpace, and add the following line:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="n">menu</span><span class="o">.</span><span class="n">selectionAction</span> <span class="o">=</span> <span class="n">stars</span><span class="o">.</span><span class="n">goto</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Your WorkSpace should look like this:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21</pre></td><td class="code"><pre><span class="kd">class</span> <span class="kt">WorkSpace</span><span class="p">:</span> <span class="kt">CanvasController</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">background</span> <span class="p">:</span> <span class="kt">ParallaxBackground</span><span class="p">?</span>
    <span class="k">var</span> <span class="nv">menu</span> <span class="p">:</span> <span class="kt">Menu</span><span class="p">?</span>
    <span class="k">var</span> <span class="nv">info</span> <span class="p">:</span> <span class="kt">InfoPanel</span><span class="p">?</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">canvas</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="kt">COSMOSbkgd</span>

        <span class="n">background</span> <span class="o">=</span> <span class="kt">ParallaxBackground</span><span class="p">()</span>
        <span class="n">canvas</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="n">background</span><span class="p">?</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>

        <span class="n">menu</span> <span class="o">=</span> <span class="kt">Menu</span><span class="p">()</span>
        <span class="n">menu</span><span class="p">?</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">center</span>
        <span class="n">canvas</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="n">menu</span><span class="p">?</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>

        <span class="n">info</span> <span class="o">=</span> <span class="kt">InfoPanel</span><span class="p">()</span>
        <span class="n">canvas</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="n">info</span><span class="p">?</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>

        <span class="n">menu</span><span class="p">?</span><span class="o">.</span><span class="n">selectionAction</span> <span class="o">=</span> <span class="n">background</span><span class="p">?</span><span class="o">.</span><span class="n">goto</span>
    <span class="p">}</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Run it and things should work like this for you:</p>

<p><img src="" alt="" data-id="WetJoyfulHarborseal" class="gfyitem" /></p>

<h2 id="link-menu-and-info-panel">Link Menu and Info Panel</h2>

<p>The process for linking the menu and info panel is almost identical to the previous step.</p>

<p>In <code class="highlighter-rouge">Menu.Swift</code> and at the very top of the file, above the class declaration, add the following line:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="kd">typealias</span> <span class="kt">InfoAction</span> <span class="o">=</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Also, in <code class="highlighter-rouge">Menu.swift</code> add the following class variable:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="k">var</span> <span class="nv">infoAction</span> <span class="p">:</span> <span class="kt">InfoAction</span><span class="p">?</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Then, scroll down to the <code class="highlighter-rouge">.Cancelled</code> section of the menu’s gesture and add the following condition:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8</pre></td><td class="code"><pre><span class="k">if</span> <span class="k">let</span> <span class="nv">ib</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">menuSelector</span><span class="o">.</span><span class="n">infoButton</span> <span class="p">{</span>
    <span class="k">if</span> <span class="n">ib</span><span class="o">.</span><span class="nf">hitTest</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="nv">from</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">),</span>
        <span class="k">let</span> <span class="nv">ia</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">infoAction</span> <span class="p">{</span>
            <span class="nf">delay</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span> <span class="p">{</span>
                <span class="nf">ia</span><span class="p">()</span>
            <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Finally, go back to your project’s WorkSpace and add the following line:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="n">menu</span><span class="o">.</span><span class="n">infoAction</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">show</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Run it, and you should see this:</p>

<p><img src="" alt="" data-id="EthicalIdealDevilfish" class="gfyitem" /></p>

<h2 id="ambient-audio">Ambient Audio</h2>

<p>There are two files that should be included in your project. We’re going to play as soon as the application launches.</p>

<p>In the your project’s WorkSpace, create the following two class variables:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre><span class="k">let</span> <span class="nv">audio1</span> <span class="o">=</span> <span class="kt">AudioPlayer</span><span class="p">(</span><span class="s">"audio1.mp3"</span><span class="p">)</span><span class="o">!</span>
<span class="k">let</span> <span class="nv">audio2</span> <span class="o">=</span> <span class="kt">AudioPlayer</span><span class="p">(</span><span class="s">"audio2.mp3"</span><span class="p">)</span><span class="o">!</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Then in <code class="highlighter-rouge">setup()</code>, loop and play them like so:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5</pre></td><td class="code"><pre><span class="n">audio1</span><span class="o">.</span><span class="n">loops</span> <span class="o">=</span> <span class="kc">true</span>
<span class="n">audio1</span><span class="o">.</span><span class="nf">play</span><span class="p">()</span>

<span class="n">audio2</span><span class="o">.</span><span class="n">loops</span> <span class="o">=</span> <span class="kc">true</span>
<span class="n">audio2</span><span class="o">.</span><span class="nf">play</span><span class="p">()</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Now things are sounding stellar.</p>

<h2 id="initial-stars-offset">Initial Stars Offset</h2>

<p>We prefer the stars to start offset from any particular constellation. So, open <code class="highlighter-rouge">Stars.swift</code> and add the following line to the end of <code class="highlighter-rouge">setup()</code>:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="n">bigStars</span><span class="o">.</span><span class="n">contentOffset</span> <span class="o">=</span> <span class="kt">CGPointMake</span><span class="p">(</span><span class="n">view</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="kt">CGFloat</span><span class="p">(</span><span class="n">gapBetweenSigns</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h2 id="the-last-touch">The Last Touch</h2>

<p>If you haven’t already done so, now’s the time to update a couple of simple deployment settings.</p>

<p>Click on the COSMOS project at the top of the project navigator in Xcode. Then under the General tab, navigate down to the Deployment Info section. Choose the following settings:</p>

<ul>
  <li>Portrait: selected</li>
  <li>Upside Down: selected</li>
  <li>Landscape left: unselected</li>
  <li>Landscape right: unselected</li>
  <li>Hide Status Bar: selected</li>
  <li>Requires Full Screen: selected</li>
</ul>

<p><img src="01.png" alt="" /></p>

<p>AAAAAAAAND</p>

<p>WE.</p>

<p>ARE.</p>

<p>DONE.</p>

        </div>
      </div>
    </div>

    <div class="container">
      <div class="row chapter-nav">
        <div class="col-xs-12 col-sm-12 col-md-12">
          <h1 class="text-center blue">Well done! Continue COSMOS?</h1>
          <ul class="examples-list next-prev list-unstyled">
            
              <li class="pull-left">
                <a class="more" href="/cosmos/22-Info-Panel" title="Earlier article: Info Panel">
                  <div>
                    <span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span>
                    <span class="img">
                      <img src="/images/cosmos/22/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 22<br />Info Panel</p>
                      <p>A straightforward info panel with push controllers, popups and external links.</p>
                    </div>
                  </div>
                </a>
              </li>
            
            
              <li class="pull-right">
                <a class="more" href="/cosmos/24-Pulling-It-All-Together" title="Later article: Submitting to App Store">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/24/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 24<br />Submitting to App Store</p>
                      <p>Our last task is to get COSMOS on the App Store. Seriously.</p>
                    </div>
                    <span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>
                  </div>
                </a>
              </li>
            
          </ul>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="row related">
        <div class="col-xs-12 col-md-12">
          <h1 class="text-center blue">All COSMOS Chapters</h1>
          <ul class="examples-list list-unstyled">
            
            
              <li>
                <a href="/cosmos/0-getting-started">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/0/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 0<br />Getting Started</p>
                      <p>Get up and running quickly with the COSMOS Xcode project files.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/1-prelude-to-design">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/1/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 1<br />Prelude To Design</p>
                      <p>An overview explaining why & how we chose to create COSMOS in the first place.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/2-designing-the-cosmos">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/2/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 2<br />Designing the COSMOS</p>
                      <p>Where to start? Defining the visual concept and deciding the functionality.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/3-plan-it">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/3/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 3<br />Plan It!</p>
                      <p>Get your goggles on as we start diving into the code with C4.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/4-Infinite-Scrollview">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/4/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 4<br />Infinite Scrollview</p>
                      <p>Implementing the idea of an infinite scrollview that loops around rather than stopping at the end.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/5-Infinite-Scrollview-Build">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/5/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 5<br />Infinite Scrollview</p>
                      <p>Time to code – get that infinite scrollview looping.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/6-Astrological-Sign-Provider">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/6/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 6<br />Astrological Sign Provider</p>
                      <p>How to go about wrangling all the data for the 12 astrological signs.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/7-Astrological-Sign-Provider-Build">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/7/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 7<br />Astrological Sign Provider - Build it!</p>
                      <p>We've wrangled all that data, now let's do something with it.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/8-Stars">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/8/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 8<br />Stars</p>
                      <p>Start bringing the COSMOS to life with some nice visual work.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/9-Parallax-Testing">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/9/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 9<br />Parallax Testing (Optional)</p>
                      <p>This optional chapter will walk you through how I originally tested the background.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/10-Stars-Background">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/10/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 10<br />Stars Background</p>
                      <p>Time to stargaze – we're going to build some constellations.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/11-Sign-Lines">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/11/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 11<br />Sign Lines</p>
                      <p>Time to stargaze – we're going to build some constellations.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/12-Small-Stars">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/12/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 12<br />Small Stars</p>
                      <p>Bring those constellations to life with stars. We're starting small.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/13-Big-Stars">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/13/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 13<br />Big Stars</p>
                      <p>We've got the small constellation stars, let's keep going with the big ones.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/14-Assembling-The-Stars">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/14/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 14<br />Assembling the Stars</p>
                      <p>Small stars, meet big stars. Time to unite them all.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/15-Radial-Menu">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/15/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 15<br />Radial Menu</p>
                      <p>Building the heart of the app - a radial menu with embedded animation that reacts to different gestures.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/16-Menu-Rings">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/16/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 16<br />Menu Rings</p>
                      <p>It's time to build the backbone of our radial menu.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/17-Menu-Rings">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/17/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 17<br />Animating the Menu Rings</p>
                      <p>Time to bring the radial menu to life with embedded animation.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/18-Menu-Icons">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/18/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 18<br />Menu Icons</p>
                      <p>Time to flesh out the radial menu with some animated icons.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/19-Menu-Selector">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/19/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 19<br />Menu Selector</p>
                      <p>Give the radial menu interaction and responsiveness with some programming wizardry.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/20-Menu-Shadow">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/20/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 20<br />Menu Shadow</p>
                      <p>Give a little visual pop to the radial menu with a simple shadow.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/21-Menu-Pull-It-Together">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/21/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 21<br />The Menu – Pull it Together</p>
                      <p>We've got all the components, let's get this beast put together now.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/22-Info-Panel">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/22/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 22<br />Info Panel</p>
                      <p>A straightforward info panel with push controllers, popups and external links.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/23-Pulling-It-All-Together">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/23/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 23<br />Pulling It All Together</p>
                      <p>Time to weave all the components into a unified app.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/24-Pulling-It-All-Together">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/24/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 24<br />Submitting to App Store</p>
                      <p>Our last task is to get COSMOS on the App Store. Seriously.</p>
                    </div>
                  </div>
                </a>
              </li>
            
          </ul>
        </div>
      </div>
    </div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-md-3 col-sm-3 col-xs-6">
        <ul class="list-unstyled">
          <li class="title"><a href="/#overview">About</a></li>
          <li><a href="/#overview">Features</a></li>
          <!-- <li><a href="/about#history">History</a></li> -->
          <!-- <li><a href="/about/contributors">Contributors</a></li> -->
        </ul>
      </div>
      <div class="col-md-3 col-sm-3 col-xs-6">
        <ul class="list-unstyled">
          <li class="title"><a href="/learn">Learn + Explore</a></li>
          <li><a href="/install">Install C4</a></li>
          <li><a href="/examples">Examples</a></li>
          <li><a href="/tutorials">Tutorials</a></li>
          <li><a href="http://cocoadocs.org/docsets/C4/1.1.0/">Docs</a></li>
        </ul>
      </div>
      <div class="col-md-3 col-sm-3 col-xs-6">
        <ul class="list-unstyled">
          <li class="title"><a href="/contact">Connect</a></li>
          <li><a href="http://discourse.c4ios.com">Forums</a></li>
          <li><a href="http://www.medium.com/@c4framework" target="_blank">Medium</a></li>
          <li><a href="http://www.twitter.com/c4framework" target="_blank">Twitter</a></li>
          <li><a href="https://join-c4.herokuapp.com/" target="_blank">Slack</a></li>
          <li><a href="https://vimeo.com/c4ios" target="_blank">Vimeo</a></li>
          <li><a href="http://github.com/c4framework" target="_blank">GitHub</a></li>
        </ul>
      </div>
      <div class="col-md-3 col-sm-3 col-xs-6">
        <ul class="list-unstyled">
          <!-- <li class="title"><a href="/about">Sign Up for Newsletter</a></li>
          <li><input type="text" placeholder="Enter Email + Press Enter"></li> -->
          <li>© 2016 C4</li>
          <li><a href="/terms">Terms of Use</a></li>
          <li><a href="mailto:info@c4ios.com">Contact</a></li>
        </ul>    
      </div>
    </div>
  </div>
</footer>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-18444113-4', 'auto');
  ga('send', 'pageview');
</script>


    <script type="text/javascript" src="/js/toc.js"></script>
    <script>
     (function(d, t) {
        var g = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        g.src = 'http://assets.gfycat.com/js/gfyajax-0.517d.js';
        s.parentNode.insertBefore(g, s);
      }(document, 'script'));
    </script>
    <script type="text/javascript">
      $(document).ready(function() {
        $('#toc').width($('#toc').parents().width());

        $('#toc').toc({
          elementClass: 'toc',
          ulClass: 'nav',
          heading: 'Contents',
          indexingFormats: 'number',
          selector: 'h2, h3, h4',
        });

        $('body').scrollspy({
          target: '#toc',
          offset: $('#headerNav').outerHeight(true)
        });

        setTimeout(function() {
          var $sideBar = $('#toc');
          $sideBar.affix({
            offset: {
              top: function() {
                var offsetTop      = $sideBar.offset().top,
                sideBarMargin  = parseInt($sideBar.children(0).css('margin-top'), 10),
                navOuterHeight = $('#headerNav').height();
                return (this.top = offsetTop - navOuterHeight - sideBarMargin);
              },
              bottom: function() {
                return (this.bottom = $('footer').outerHeight(true) + $('.chapter-nav').outerHeight(true) + $('.related').outerHeight(true) + 60);
              }
            }
          });
        }, 100);

        $('td.gutter').each(function(index)
        {
          $(this).parents('.language-swift').closest('pre').addClass('has-gutter');
        });

        $('.tutorial img').each(function()
        {
          console.log($(this).parent());
          var img = $(this).attr('src');
          $(this).attr('src', '/images/cosmos/23/' + img + '').addClass('img-responsive');
        });

        $('.tutorial p img').unwrap().wrap('<figure></figure>').after(function() {
            return '<figcaption>'+this.alt+'</figcaption>';
        });

        $('.footnotes').prepend('<h4>Footnotes</h4>');
      });
    </script>
  </body>
</html>