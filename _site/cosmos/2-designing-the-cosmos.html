<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
	

  <title>Designing the COSMOS</title>
  <meta name="description" content="March 11th, I have an offer on the table to write a tutorial and have it published on a renown site. So, I start talking with Jake about coming up with possi...">
  <meta property="og:image" content="http://www.c4ios.com/images/banner.jpg">
  <meta property="og:url"   content="http://c4ios.com" />
  <meta property="og:title" content="Designing the COSMOS"/>
  <meta name="og:description" content="March 11th, I have an offer on the table to write a tutorial and have it published on a renown site. So, I start talking with Jake about coming up with possi...">
  <meta property="og:type"  content="website"/>
  <meta property="og:site_name"  content="C4"/>

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@c4framework">
  <meta name="twitter:creator" content="@c4framework">
  <meta name="twitter:title" content="Designing the COSMOS">
  <meta name="twitter:description" content="March 11th, I have an offer on the table to write a tutorial and have it published on a renown site. So, I start talking with Jake about coming up with possi...">
  <meta name="twitter:image" content="http://www.c4ios.com/images/banner.jpg">


  <link rel="stylesheet" type="text/css" href="/css/style.css" >
  <link rel="stylesheet" href="/css/syntax.css">
  <link href='https://fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'>

  <link rel="canonical" href="www.c4ios.com/cosmos/2-designing-the-cosmos">
  <link rel="alternate" type="application/rss+xml" title="C4 website" href="www.c4ios.com/feed.xml">
</head>

    <body class="designing-the-cosmos" data-spy="scroll" data-target="#toc">

    <header>
  <nav class="navbar navbar-default" role="navigation"> 
    <div class="navbar-header container">
      <div class="row"> 
        <div class="col-xs-12 col-sm-12 col-md-12 navlist">
          <a class="navbar-brand" href="/">
            <span><img src="/images/c4logo.png"></span>
          </a>
          <ul class="nav navbar-nav navbar-left">
            <li><a href="/install" >Install</a></li>
            <li><a href="/tutorials" >Tutorials</a></li>
            <li><a href="/cosmos" class='active'>COSMOS</a></li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li><a href="/examples" >Examples</a></li>
            <li><a href="http://discourse.c4ios.com">Forums</a></li>
            <li><a href="http://cocoadocs.org/docsets/C4/1.1.0/">Documentation</a></li>
          </ul>
        </div>
      </div>  
    </div>        
  </nav>      
</header>

    <div class="container content designing-the-cosmos" >
      <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 breadcrumb">
          <h1><a href="/tutorials">Tutorials</a><div class="bread-caret">></div><a href="/cosmos">COSMOS</a><div class="bread-caret">></div>Designing the COSMOS</h1>
        </div>
      </div>

      <div class="row">
        <div class="col-xs-3 col-sm-3 col-md-3">
          <span class="img large">
            <img src="/images/cosmos/1/poster.png" />
          </span>
          <p class="title">Chapter 2<br /><span class="lighter">Designing the COSMOS</span></p>
          <p>Tags<br /><a href="/tag/tutorial">tutorial</a>, <a href="/tag/c4">c4</a>, <a href="/tag/cosmos">cosmos</a>, <a href="/tag/ios">ios</a>, </p>
          <p>Estimated Time<br /><span class="lighter">10 - 20 hours</span></p>

          <hr />

          <div id="toc"></div>
        </div>

        <div class="col-xs-9 col-sm-9 col-md-9 tutorial">
          <p>March 11th, I have an offer on the table to write a tutorial and have it published on a renown site. So, I start talking with Jake about coming up with possible concepts we can design, build and publish. Starting to get a grip on the new Swift-based C4, learning how to build animations with the new system… Thinking: lots of basic animations coming together into a nice, elegant interface. Watch a lot of concept UI videos. Brainstorm.</p>

<p>Jake gets an idea:</p>

<blockquote>
  <p>…where it starts as one filled circle in the middle, when you tap it, it shrinks a bit (90% size), and then shoots out 8 circles from that central point where all those circles create a bigger circle of “sub menus” which are just outlines of circles with different icons in each circle. Then, tapping an X in the centre will pull them all back into the original state.</p>
</blockquote>

<p><img src="01.png" alt="" /></p>

<p>Watch more videos.</p>

<p>Talk about the concept.</p>

<p>It works.</p>

<p>Run with it.</p>

<p>That’s how we roll.</p>

<h2 id="mocks--tests">Mocks &amp; Tests</h2>

<p>The actual app is simple, there are a lot of subtle elements in the interface and background that will take some time to get just right. Also, because the app is simple – yet complex – it will make for a good set of tutorials on how to build it from end-to-end using C4.</p>

<p><img src="02.png" alt="" /></p>

<p>Jake presents his concepts for a single-view app composed of a brilliant animated menu and a layered parallax background that holds all the content. I have a look at both and in my head do a tear-down of how both components will be composed.</p>

<h2 id="background">Background</h2>
<p>The background is the easy one to decompose, mainly because it’s just a bunch of layers with different content moving at different speeds.</p>

<p><img src="03.png" alt="" /></p>

<p>There are:</p>

<ul>
  <li>Big stars</li>
  <li>Small stars</li>
  <li>Lines connecting the stars</li>
  <li>3 layers of background stars</li>
  <li>2 layers of nebulas (for texture)</li>
</ul>

<p>This is totally possible, so after a chat with Jake I come up with a list of things I need defined from him for this part:</p>

<ul>
  <li>Degrees / indicator animation</li>
  <li>Individual Constellations</li>
  <li>3-layer foreground style + movements</li>
  <li>3-layer STAR background style + movements (incl. # of stars)</li>
  <li>2-layer Nebula background style + movements</li>
</ul>

<p>My first step at this point is to test the number of layers I can get doing parallax at the same time… We need 8, so I just test with 10 to make sure it will work.</p>

<blockquote>
  <p>The code in this chapter represents the tests I made prior to deciding to move forward. So, when you’re done with the chapter, remember to delete everything you’ve added to the workspace file.</p>
</blockquote>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17</pre></td><td class="code"><pre><span class="kd">class</span> <span class="kt">WorkSpace</span><span class="p">:</span> <span class="kt">CanvasController</span> <span class="p">{</span>
    <span class="c1">//creates an empty variable array to which we'll add layers</span>
    <span class="k">var</span> <span class="nv">layers</span> <span class="o">=</span> <span class="p">[</span><span class="kt">UIScrollView</span><span class="p">]()</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">//loops the code while the number of layers in our array is less than 10</span>
        <span class="k">repeat</span> <span class="p">{</span>
            <span class="c1">//creates a layer whose frame is the same as the canvas</span>
            <span class="k">let</span> <span class="nv">layer</span> <span class="o">=</span> <span class="kt">UIScrollView</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="n">view</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
            <span class="c1">//sets the content size for each layer, keeping 0 for height to prevent vertical scrolling</span>
            <span class="n">layer</span><span class="o">.</span><span class="n">contentSize</span> <span class="o">=</span> <span class="kt">CGSizeMake</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="c1">//add the layer to the canvas and to the array</span>
            <span class="n">canvas</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
            <span class="n">layers</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">while</span> <span class="n">layers</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;</span> <span class="mi">10</span>
    <span class="p">}</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Pretty straightforward. I’m working from the same project as the previous chapter, and in the project’s WorkSpace, I add a repeating loop that creates a new layer and adds it to the canvas until there are 10 layers. As each is being created, I make sure to set the layer’s contentSize to something quite large (in this case 20 times the width of the canvas). Setting the size’s height value to 0 will make sure it doesn’t scroll vertically.</p>

<p>At this point, if I run the app I’ll see nothing, so I modify the loop to include adding labels to each layer.</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</pre></td><td class="code"><pre><span class="kd">class</span> <span class="kt">WorkSpace</span><span class="p">:</span> <span class="kt">CanvasController</span> <span class="p">{</span>
    <span class="c1">//creates an empty variable array to which we'll add layers</span>
    <span class="k">var</span> <span class="nv">layers</span> <span class="o">=</span> <span class="p">[</span><span class="kt">InfiniteScrollView</span><span class="p">]()</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">//loops the code while the number of layers in our array is less than 10</span>
        <span class="k">repeat</span> <span class="p">{</span>
            <span class="c1">//creates a layer whose frame is the same as the canvas</span>
            <span class="k">let</span> <span class="nv">layer</span> <span class="o">=</span> <span class="kt">InfiniteScrollView</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="n">view</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
            <span class="c1">//sets the content size for each layer, keeping 0 for height to prevent vertical scrolling</span>
            <span class="n">layer</span><span class="o">.</span><span class="n">contentSize</span> <span class="o">=</span> <span class="kt">CGSizeMake</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="c1">//add the layer to the canvas and to the array</span>
            <span class="n">canvas</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
            <span class="n">layers</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>

            <span class="c1">//create a variable center point which will be used to position the labels</span>
            <span class="k">var</span> <span class="nv">center</span> <span class="o">=</span> <span class="kt">Point</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">canvas</span><span class="o">.</span><span class="n">height</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span>
            <span class="c1">//calculate the layer number (since we're adding the last layer first we start with 10 and work downwards)</span>
            <span class="k">let</span> <span class="nv">layerNumber</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">-</span> <span class="n">layers</span><span class="o">.</span><span class="n">count</span>
            <span class="c1">//create a font whose size is based on the current layer count</span>
            <span class="k">let</span> <span class="nv">font</span> <span class="o">=</span> <span class="kt">Font</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"AvenirNext-DemiBold"</span><span class="p">,</span> <span class="nv">size</span><span class="p">:</span><span class="kt">Double</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">count</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">8.0</span><span class="p">)</span><span class="o">!</span>
            <span class="c1">//create a loop that runs until each layer is full of labels</span>
            <span class="k">repeat</span> <span class="p">{</span>
                <span class="c1">//create a label</span>
                <span class="k">let</span> <span class="nv">label</span> <span class="o">=</span> <span class="kt">TextShape</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="s">"</span><span class="se">\(</span><span class="n">layerNumber</span><span class="se">)</span><span class="s">"</span><span class="p">,</span> <span class="nv">font</span><span class="p">:</span> <span class="n">font</span><span class="p">)</span><span class="o">!</span>
                <span class="c1">//center it</span>
                <span class="n">label</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>
                <span class="c1">//update the center point's position</span>
                <span class="n">center</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="mf">130.0</span>
                <span class="c1">//add the label to the layer</span>
                <span class="n">layer</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">while</span> <span class="n">center</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="kt">Double</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">contentSize</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">while</span> <span class="n">layers</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;</span> <span class="mi">10</span>
    <span class="p">}</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>This modifies the original setup to include a nested repeat that runs until the entire content size of the layer is filled with labels – with each label numbered based on the current layer.</p>

<p>Now, when the app runs there are labels. But! If I scroll the app only one layer moves…</p>

<p><img src="" alt="" data-id="DishonestDescriptiveBassethound" class="gfyitem" /></p>

<p>The next step is to create an observer that looks at the top layer and moves all the rest when it is being scrolled. So, in setup just after the end of the while, I add the following:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6</pre></td><td class="code"><pre><span class="k">if</span> <span class="k">let</span> <span class="nv">top</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">last</span> <span class="p">{</span>
    <span class="c1">//creates a variable context</span>
    <span class="k">var</span> <span class="nv">c</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1">//adds the WorkSpace as an observer of the top layer's contentOffset</span>
    <span class="n">top</span><span class="o">.</span><span class="nf">addObserver</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKeyPath</span><span class="p">:</span> <span class="s">"contentOffset"</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="kt">NSKeyValueObservingOptions</span><span class="o">.</span><span class="kt">New</span><span class="p">,</span> <span class="nv">context</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">c</span><span class="p">)</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>This bit sets up the WorkSpace as observer of the top layer’s contentOffset. Now, to make things pretty, I create a function that will respond to the movement of the layer and change the other ones accordingly. Like so:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14</pre></td><td class="code"><pre><span class="k">override</span> <span class="kd">func</span> <span class="nf">observeValueForKeyPath</span><span class="p">(</span><span class="nv">keyPath</span><span class="p">:</span> <span class="kt">String</span><span class="p">?,</span> <span class="n">ofObject</span> <span class="nv">object</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">?,</span> <span class="nv">change</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span> <span class="p">:</span> <span class="kt">AnyObject</span><span class="p">]?,</span> <span class="nv">context</span><span class="p">:</span> <span class="kt">UnsafeMutablePointer</span><span class="o">&lt;</span><span class="kt">Void</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//iterates through all the layers, stopping 1 before the top layer</span>
    <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">0</span><span class="o">..&lt;</span><span class="n">layers</span><span class="o">.</span><span class="n">count</span><span class="o">-</span><span class="mi">1</span> <span class="p">{</span>
        <span class="c1">//grabs the current layer</span>
        <span class="k">let</span> <span class="nv">layer</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="c1">//creates a mod value based on the layer's position (layer 0 = 0.1, layer 1 = 0.2, ...)</span>
        <span class="k">let</span> <span class="nv">mod</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="kt">CGFloat</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1">//grabs the x value of the top layer's content offset</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">last</span><span class="p">?</span><span class="o">.</span><span class="n">contentOffset</span><span class="o">.</span><span class="n">x</span> <span class="p">{</span>
            <span class="c1">//sets the content offset of the current layer by multiplying x by mod</span>
            <span class="n">layer</span><span class="o">.</span><span class="n">contentOffset</span> <span class="o">=</span> <span class="kt">CGPointMake</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">mod</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p><img src="" alt="" data-id="RequiredSilentAfricangoldencat" class="gfyitem" /></p>

<p>Pretty. Now we know that 10 layers will definitely work… But, what about when there’s a ton of media in them?… Time to test that. Jake ballparks the number of stars per “view” per layer at 15, and gives me a small white star.</p>

<p>I then swap the internal repeat loop to a for that adds images rather than labels. It looks like this now:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16</pre></td><td class="code"><pre><span class="c1">//instead of center position, I simply add 10 * 15 stars per layer</span>
<span class="k">let</span> <span class="nv">starCount</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">count</span> <span class="o">*</span> <span class="mi">15</span>
<span class="n">canvas</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="n">black</span>
<span class="c1">//loop until there starCount stars in the layer</span>
<span class="k">for</span> <span class="n">_</span> <span class="k">in</span> <span class="mi">0</span><span class="o">..&lt;</span><span class="n">starCount</span> <span class="p">{</span>
    <span class="c1">//create an image for the star</span>
    <span class="k">let</span> <span class="nv">img</span> <span class="o">=</span> <span class="kt">Image</span><span class="p">(</span><span class="s">"6smallStar"</span><span class="p">)</span><span class="o">!</span>
    <span class="c1">//allow it to scale proportionately</span>
    <span class="n">img</span><span class="o">.</span><span class="n">constrainsProportions</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="c1">//scale the width of the image</span>
    <span class="n">img</span><span class="o">.</span><span class="n">width</span> <span class="o">*=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="kt">Double</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">count</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1">//center it at a random point in the layer</span>
    <span class="n">img</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="kt">Point</span><span class="p">(</span><span class="kt">Double</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">contentSize</span><span class="o">.</span><span class="n">width</span><span class="p">)</span><span class="o">*</span><span class="nf">random01</span><span class="p">(),</span><span class="n">canvas</span><span class="o">.</span><span class="n">height</span><span class="o">*</span><span class="nf">random01</span><span class="p">())</span>
    <span class="c1">//add it to the layer</span>
    <span class="n">layer</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>And, the simulator looks good:</p>

<p><img src="" alt="" data-id="NippyQuaintBrownbear" class="gfyitem" /></p>

<p>I try it on an iPhone 5 and it runs just fine. The 10-layer test works, so the only remaining bits to work out are aesthetics. And, by this point Jake has basically specified everything on the lists at the top of the Background section.</p>

<h3 id="individual-constellations">Individual Constellations</h3>

<p>Each of the 12 astrological signs will be made up of 3 visual elements: big stars, small stars and lines connecting the shapes. This is the image that jake used to trace the positions of each kind of star:</p>

<p><img src="09.png" alt="See the big and small stars" /></p>

<h3 id="three-layer-foreground-style--movements">Three-layer foreground style + movements</h3>

<p>The next thing to define is “how” the stars and lines move in the foreground layers. Jake’s idea is to have the stars shift into place, so we decide to make 3 layers one for each of the big / small stars and one for the lines. When the app snaps into place for any given sign, the current stars should line up in the right positions. Then, right as everything snaps, there’s a super short animation of the lines between stars drawing from one star to another.</p>

<p><img src="10.png" alt="" /></p>

<h3 id="three-layer-star-background-style--movements">Three-layer STAR background style + movements</h3>

<p>Next, I get jake to define how the stars move in the background. This step is pretty simple, he thinks its something like 5%, 15% and 20% of the speed of topmost layer. He also makes some ballpark guesses on how many stars per layer.</p>

<p><img src="11.png" alt="" /></p>

<h3 id="two-layer-nebula-background-style--movements">Two-layer Nebula background style + movements</h3>

<p>Next, I get Jake to define how the nebula and vignette are going to look and move. This step is even easier than the previous one because the vignette simply doesn’t move, and the nebula layer moves at 10% speed.</p>

<p><img src="12.png" alt="" /></p>

<h3 id="degrees--indicator-animation">Degrees / indicator animation</h3>

<p>Finally, there will be a dashed line at the bottom of entire window, with a longer dash every 20 dashes. Then, when each individual constellation is centered there will be an even longer white line positioned under a graphic symbol of the constellation and its position (in degrees).</p>

<p><img src="13.png" alt="Initial layer specifications, which we modified on the fly after looking at a running version of the layers." /></p>

<h3 id="finally">Finally</h3>

<p>The last step before moving on is to have a list of the different layers that I’m going to be building. In his infinite kindness, Jake sends me this:</p>

<p><img src="14.png" alt="" /></p>

<h2 id="menu">Menu</h2>

<p>The menu “looks” pretty straightforward, except that it isn’t. However, the only real thing that I need to figure out is how we’re going to animate the astrological signs.</p>

<p><img src="15.png" alt="Jake wanted to use this diagram as the basis for the shapes of the astrological signs." /></p>

<p>Actually, animating them is the easy part, but making them is trickier because we want them to be bezier paths but constructing them is a pain because we don’t know the curve points and applications like Illustrator don’t give us access to those. Also, I don’t want to write an SVG importer because that’s overkill…</p>

<p>So, what do we do?</p>

<p>We use <a href="http://www.paintcodeapp.com">PaintCode</a> to draw out trace the shapes and then export their curvatures to Core Graphics code which looks like this:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6</pre></td><td class="code"><pre><span class="kt">UIBezierPath</span><span class="o">*</span> <span class="n">bezier2Path</span> <span class="o">=</span> <span class="kt">UIBezierPath</span><span class="o">.</span><span class="n">bezierPath</span><span class="p">;</span>
<span class="p">[</span><span class="n">bezier2Path</span> <span class="nv">moveToPoint</span><span class="p">:</span> <span class="kt">CGPointMake</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">200</span><span class="p">)];</span>
<span class="p">[</span><span class="n">bezier2Path</span> <span class="nv">addLineToPoint</span><span class="p">:</span> <span class="kt">CGPointMake</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">200</span><span class="p">)];</span>
<span class="p">[</span><span class="n">bezier2Path</span> <span class="nv">addCurveToPoint</span><span class="p">:</span> <span class="kt">CGPointMake</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span> <span class="nv">controlPoint1</span><span class="p">:</span> <span class="kt">CGPointMake</span><span class="p">(</span><span class="mf">122.4</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span> <span class="nv">controlPoint2</span><span class="p">:</span> <span class="kt">CGPointMake</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mf">177.6</span><span class="p">)];</span>
<span class="o">...</span>
<span class="p">[</span><span class="n">bezier2Path</span> <span class="n">closePath</span><span class="p">];</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>When I translate to code that looks like this:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6</pre></td><td class="code"><pre><span class="k">let</span> <span class="nv">bezier</span> <span class="o">=</span> <span class="kt">Path</span><span class="p">()</span>

<span class="n">bezier</span><span class="o">.</span><span class="nf">moveToPoint</span><span class="p">(</span><span class="kt">Point</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span><span class="mi">200</span><span class="p">))</span>
<span class="n">bezier</span><span class="o">.</span><span class="nf">addLineToPoint</span><span class="p">(</span><span class="kt">Point</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span><span class="mi">200</span><span class="p">))</span>
<span class="n">bezier</span><span class="o">.</span><span class="nf">addCurveToPoint</span><span class="p">(</span><span class="kt">Point</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">150</span><span class="p">),</span> <span class="nv">control1</span><span class="p">:</span><span class="kt">Point</span><span class="p">(</span><span class="mf">122.4</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span> <span class="nv">control2</span><span class="p">:</span><span class="kt">Point</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mf">177.6</span><span class="p">))</span>
<span class="o">...</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Things start to get more clear, and much easier to work with. Now that I have a process for getting the shapes of the astrological signs into C4 code it takes little effort to animate them the way we intend.</p>

<p>For example, letting a shape draw itself in is as simple as specifying:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="n">shape</span><span class="o">.</span><span class="n">strokeEnd</span> <span class="o">=</span> <span class="mf">1.0</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h3 id="redlines">Redlines</h3>

<p>At this point I’m ready to start building out the menu, but to do so I need redlines – specifications on position, size, etc., – for all the elements in the menu.</p>

<p>Jake does a lovely job of prepping this for me:</p>

<p><img src="16.png" alt="All the lovely details a coder needs for the menu" /></p>

<h2 id="time-to-go">Time To Go</h2>

<p>With the basic visual concepts specified, and the more complicated or questionable bits tested, it’s time to move on to some real dev work. But, before we get going I’ll sum up the problems I know I’ll have to address:</p>

<ol>
  <li>Custom shapes – I will be animating and reusing many shapes throughout the app, so I should build them with custom bezier paths rather than importing assets.</li>
  <li>Complex Animation Sequences – There will be a complex series of animation sequences and timing to get the right feel for the menu expanding and contracting.</li>
  <li>Defining the interaction through gestures – I’ll want to keep the gestures for interacting as simple as possible, while making them unique.</li>
  <li>Parallax + Infinite Scrollview – adding parallax to the app is a must, so I’ll need to be careful that performance stays relatively high when the app is produced.</li>
</ol>

<blockquote>
  <p>MAKE SURE TO DELETE ANY TEST CODE YOU’VE INCORPORATED INTO WorkSpace.swift… You should only have an empty setup().</p>
</blockquote>

<p>Let’s go.</p>

        </div>
      </div>
    </div>

    <div class="container">
      <div class="row chapter-nav">
        <div class="col-xs-12 col-sm-12 col-md-12">
          <h1 class="text-center blue">Well done! Continue COSMOS?</h1>
          <ul class="examples-list next-prev list-unstyled">
            
              <li class="pull-left">
                <a class="more" href="/cosmos/1-prelude-to-design" title="Earlier article: Prelude To Design">
                  <div>
                    <span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span>
                    <span class="img">
                      <img src="/images/cosmos/1/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 1<br />Prelude To Design</p>
                      <p>An overview explaining why & how we chose to create COSMOS in the first place.</p>
                    </div>
                  </div>
                </a>
              </li>
            
            
              <li class="pull-right">
                <a class="more" href="/cosmos/3-plan-it" title="Later article: Plan It!">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/3/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 3<br />Plan It!</p>
                      <p>Get your goggles on as we start diving into the code with C4.</p>
                    </div>
                    <span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>
                  </div>
                </a>
              </li>
            
          </ul>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="row related">
        <div class="col-xs-12 col-md-12">
          <h1 class="text-center blue">All COSMOS Chapters</h1>
          <ul class="examples-list list-unstyled">
            
            
              <li>
                <a href="/cosmos/0-getting-started">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/0/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 0<br />Getting Started</p>
                      <p>Get up and running quickly with the COSMOS Xcode project files.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/1-prelude-to-design">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/1/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 1<br />Prelude To Design</p>
                      <p>An overview explaining why & how we chose to create COSMOS in the first place.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/2-designing-the-cosmos">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/2/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 2<br />Designing the COSMOS</p>
                      <p>Where to start? Defining the visual concept and deciding the functionality.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/3-plan-it">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/3/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 3<br />Plan It!</p>
                      <p>Get your goggles on as we start diving into the code with C4.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/4-Infinite-Scrollview">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/4/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 4<br />Infinite Scrollview</p>
                      <p>Implementing the idea of an infinite scrollview that loops around rather than stopping at the end.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/5-Infinite-Scrollview-Build">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/5/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 5<br />Infinite Scrollview</p>
                      <p>Time to code – get that infinite scrollview looping.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/6-Astrological-Sign-Provider">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/6/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 6<br />Astrological Sign Provider</p>
                      <p>How to go about wrangling all the data for the 12 astrological signs.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/7-Astrological-Sign-Provider-Build">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/7/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 7<br />Astrological Sign Provider - Build it!</p>
                      <p>We've wrangled all that data, now let's do something with it.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/8-Stars">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/8/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 8<br />Stars</p>
                      <p>Start bringing the COSMOS to life with some nice visual work.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/9-Parallax-Testing">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/9/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 9<br />Parallax Testing (Optional)</p>
                      <p>This optional chapter will walk you through how I originally tested the background.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/10-Stars-Background">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/10/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 10<br />Stars Background</p>
                      <p>Time to stargaze – we're going to build some constellations.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/11-Sign-Lines">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/11/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 11<br />Sign Lines</p>
                      <p>Time to stargaze – we're going to build some constellations.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/12-Small-Stars">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/12/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 12<br />Small Stars</p>
                      <p>Bring those constellations to life with stars. We're starting small.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/13-Big-Stars">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/13/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 13<br />Big Stars</p>
                      <p>We've got the small constellation stars, let's keep going with the big ones.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/14-Assembling-The-Stars">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/14/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 14<br />Assembling the Stars</p>
                      <p>Small stars, meet big stars. Time to unite them all.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/15-Radial-Menu">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/15/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 15<br />Radial Menu</p>
                      <p>Building the heart of the app - a radial menu with embedded animation that reacts to different gestures.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/16-Menu-Rings">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/16/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 16<br />Menu Rings</p>
                      <p>It's time to build the backbone of our radial menu.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/17-Menu-Rings">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/17/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 17<br />Animating the Menu Rings</p>
                      <p>Time to bring the radial menu to life with embedded animation.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/18-Menu-Icons">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/18/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 18<br />Menu Icons</p>
                      <p>Time to flesh out the radial menu with some animated icons.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/19-Menu-Selector">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/19/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 19<br />Menu Selector</p>
                      <p>Give the radial menu interaction and responsiveness with some programming wizardry.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/20-Menu-Shadow">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/20/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 20<br />Menu Shadow</p>
                      <p>Give a little visual pop to the radial menu with a simple shadow.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/21-Menu-Pull-It-Together">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/21/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 21<br />The Menu – Pull it Together</p>
                      <p>We've got all the components, let's get this beast put together now.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/22-Info-Panel">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/22/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 22<br />Info Panel</p>
                      <p>A straightforward info panel with push controllers, popups and external links.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/23-Pulling-It-All-Together">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/23/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 23<br />Pulling It All Together</p>
                      <p>Time to weave all the components into a unified app.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/24-Pulling-It-All-Together">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/24/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 24<br />Submitting to App Store</p>
                      <p>Our last task is to get COSMOS on the App Store. Seriously.</p>
                    </div>
                  </div>
                </a>
              </li>
            
          </ul>
        </div>
      </div>
    </div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-md-3 col-sm-3 col-xs-6">
        <ul class="list-unstyled">
          <li class="title"><a href="/#overview">About</a></li>
          <li><a href="/#overview">Features</a></li>
          <!-- <li><a href="/about#history">History</a></li> -->
          <!-- <li><a href="/about/contributors">Contributors</a></li> -->
        </ul>
      </div>
      <div class="col-md-3 col-sm-3 col-xs-6">
        <ul class="list-unstyled">
          <li class="title"><a href="/learn">Learn + Explore</a></li>
          <li><a href="/install">Install C4</a></li>
          <li><a href="/examples">Examples</a></li>
          <li><a href="/tutorials">Tutorials</a></li>
          <li><a href="http://cocoadocs.org/docsets/C4/1.1.0/">Docs</a></li>
        </ul>
      </div>
      <div class="col-md-3 col-sm-3 col-xs-6">
        <ul class="list-unstyled">
          <li class="title"><a href="/contact">Connect</a></li>
          <li><a href="http://discourse.c4ios.com">Forums</a></li>
          <li><a href="http://www.medium.com/@c4framework" target="_blank">Medium</a></li>
          <li><a href="http://www.twitter.com/c4framework" target="_blank">Twitter</a></li>
          <li><a href="https://join-c4.herokuapp.com/" target="_blank">Slack</a></li>
          <li><a href="https://vimeo.com/c4ios" target="_blank">Vimeo</a></li>
          <li><a href="http://github.com/c4framework" target="_blank">GitHub</a></li>
        </ul>
      </div>
      <div class="col-md-3 col-sm-3 col-xs-6">
        <ul class="list-unstyled">
          <!-- <li class="title"><a href="/about">Sign Up for Newsletter</a></li>
          <li><input type="text" placeholder="Enter Email + Press Enter"></li> -->
          <li>© 2016 C4</li>
          <li><a href="/terms">Terms of Use</a></li>
          <li><a href="mailto:info@c4ios.com">Contact</a></li>
        </ul>    
      </div>
    </div>
  </div>
</footer>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-18444113-4', 'auto');
  ga('send', 'pageview');
</script>


    <script type="text/javascript" src="/js/toc.js"></script>
    <script>
     (function(d, t) {
        var g = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        g.src = 'http://assets.gfycat.com/js/gfyajax-0.517d.js';
        s.parentNode.insertBefore(g, s);
      }(document, 'script'));
    </script>
    <script type="text/javascript">
      $(document).ready(function() {
        $('#toc').width($('#toc').parents().width());

        $('#toc').toc({
          elementClass: 'toc',
          ulClass: 'nav',
          heading: 'Contents',
          indexingFormats: 'number',
          selector: 'h2, h3, h4',
        });

        $('body').scrollspy({
          target: '#toc',
          offset: $('#headerNav').outerHeight(true)
        });

        setTimeout(function() {
          var $sideBar = $('#toc');
          $sideBar.affix({
            offset: {
              top: function() {
                var offsetTop      = $sideBar.offset().top,
                sideBarMargin  = parseInt($sideBar.children(0).css('margin-top'), 10),
                navOuterHeight = $('#headerNav').height();
                return (this.top = offsetTop - navOuterHeight - sideBarMargin);
              },
              bottom: function() {
                return (this.bottom = $('footer').outerHeight(true) + $('.chapter-nav').outerHeight(true) + $('.related').outerHeight(true) + 60);
              }
            }
          });
        }, 100);

        $('td.gutter').each(function(index)
        {
          $(this).parents('.language-swift').closest('pre').addClass('has-gutter');
        });

        $('.tutorial img').each(function()
        {
          console.log($(this).parent());
          var img = $(this).attr('src');
          $(this).attr('src', '/images/cosmos/2/' + img + '').addClass('img-responsive');
        });

        $('.tutorial p img').unwrap().wrap('<figure></figure>').after(function() {
            return '<figcaption>'+this.alt+'</figcaption>';
        });

        $('.footnotes').prepend('<h4>Footnotes</h4>');
      });
    </script>
  </body>
</html>