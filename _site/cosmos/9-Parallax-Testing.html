<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
	

  <title>Parallax Testing (Optional)</title>
  <meta name="description" content="This chapter will walk you through how I originally tested the background (speeds, layering, etc.), and is optional. If you want to see the process of how I ...">
  <meta property="og:image" content="http://www.c4ios.com/images/banner.jpg">
  <meta property="og:url"   content="http://c4ios.com" />
  <meta property="og:title" content="Parallax Testing (Optional)"/>
  <meta name="og:description" content="This chapter will walk you through how I originally tested the background (speeds, layering, etc.), and is optional. If you want to see the process of how I ...">
  <meta property="og:type"  content="website"/>
  <meta property="og:site_name"  content="C4"/>

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@c4framework">
  <meta name="twitter:creator" content="@c4framework">
  <meta name="twitter:title" content="Parallax Testing (Optional)">
  <meta name="twitter:description" content="This chapter will walk you through how I originally tested the background (speeds, layering, etc.), and is optional. If you want to see the process of how I ...">
  <meta name="twitter:image" content="http://www.c4ios.com/images/banner.jpg">


  <link rel="stylesheet" type="text/css" href="/css/style.css" >
  <link rel="stylesheet" href="/css/syntax.css">
  <link href='https://fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'>

  <link rel="canonical" href="www.c4ios.com/cosmos/9-Parallax-Testing">
  <link rel="alternate" type="application/rss+xml" title="C4 website" href="www.c4ios.com/feed.xml">
</head>

    <body class="parallax-testing-(optional)" data-spy="scroll" data-target="#toc">

    <header>
  <nav class="navbar navbar-default" role="navigation"> 
    <div class="navbar-header container">
      <div class="row"> 
        <div class="col-xs-12 col-sm-12 col-md-12 navlist">
          <a class="navbar-brand" href="/">
            <span><img src="/images/c4logo.png"></span>
          </a>
          <ul class="nav navbar-nav navbar-left">
            <li><a href="/install" >Install</a></li>
            <li><a href="/tutorials" >Tutorials</a></li>
            <li><a href="/cosmos" class='active'>COSMOS</a></li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li><a href="/examples" >Examples</a></li>
            <li><a href="http://discourse.c4ios.com">Forums</a></li>
            <li><a href="http://cocoadocs.org/docsets/C4/1.1.0/">Documentation</a></li>
          </ul>
        </div>
      </div>  
    </div>        
  </nav>      
</header>

    <div class="container content parallax-testing-(optional)" >
      <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 breadcrumb">
          <h1><a href="/tutorials">Tutorials</a><div class="bread-caret">></div><a href="/cosmos">COSMOS</a><div class="bread-caret">></div>Parallax Testing (Optional)</h1>
        </div>
      </div>

      <div class="row">
        <div class="col-xs-3 col-sm-3 col-md-3">
          <span class="img large">
            <img src="/images/cosmos/1/poster.png" />
          </span>
          <p class="title">Chapter 9<br /><span class="lighter">Parallax Testing (Optional)</span></p>
          <p class="post-tags">
  Tags<br /> 
  
  
  <a href="/tags/#getting started">getting started</a>,
  
  <a href="/tags/#basics">basics</a>,
  
  <a href="/tags/#introduction">introduction</a>,
  
  <a href="/tags/#easy">easy</a>,
  
  <a href="/tags/#c4">c4</a>
  
</p>
          <p>Estimated Time<br /><span class="lighter"></span></p>

          <hr />

          <div id="toc"></div>
        </div>

        <div class="col-xs-9 col-sm-9 col-md-9 tutorial">
          <p>This chapter will walk you through how I originally tested the background (speeds, layering, etc.), and is optional. If you want to see the process of how I make sure everything works then I highly recommend you go through this step by step.</p>

<h2 id="parallax-background">Parallax Background</h2>

<p>First, create a new file called <code class="highlighter-rouge">ParallaxBackground</code>, import <code class="highlighter-rouge">UIKit</code> (instead of <code class="highlighter-rouge">Foundation</code>), and add a class with the same name as the file (this should be a subclass of CanvasController). Your new file should look like this:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre><span class="kd">class</span> <span class="kt">ParallaxBackground</span> <span class="p">:</span> <span class="kt">CanvasController</span> <span class="p">{</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Next, add a <code class="highlighter-rouge">background</code> variable to your <code class="highlighter-rouge">WorkSpace</code> so that it initializes an instance of <code class="highlighter-rouge">ParallaxBackground</code>.</p>

<p>And, before we move on, let’s add some color variables outside our <code class="highlighter-rouge">WorkSpace</code> so that they’re available throughout the project. Your <code class="highlighter-rouge">WorkSpace</code> should look like this:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14</pre></td><td class="code"><pre><span class="kd">import</span> <span class="kt">UIKit</span>
<span class="kd">import</span> <span class="kt">C4</span>

<span class="k">let</span> <span class="nv">COSMOSprpl</span> <span class="o">=</span> <span class="kt">Color</span><span class="p">(</span><span class="nv">red</span><span class="p">:</span><span class="mf">0.565</span><span class="p">,</span> <span class="nv">green</span><span class="p">:</span> <span class="mf">0.075</span><span class="p">,</span> <span class="nv">blue</span><span class="p">:</span> <span class="mf">0.996</span><span class="p">,</span> <span class="nv">alpha</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">COSMOSblue</span> <span class="o">=</span> <span class="kt">Color</span><span class="p">(</span><span class="nv">red</span><span class="p">:</span> <span class="mf">0.094</span><span class="p">,</span> <span class="nv">green</span><span class="p">:</span> <span class="mf">0.271</span><span class="p">,</span> <span class="nv">blue</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="nv">alpha</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">COSMOSbkgd</span> <span class="o">=</span> <span class="kt">Color</span><span class="p">(</span><span class="nv">red</span><span class="p">:</span> <span class="mf">0.078</span><span class="p">,</span> <span class="nv">green</span><span class="p">:</span> <span class="mf">0.118</span><span class="p">,</span> <span class="nv">blue</span><span class="p">:</span> <span class="mf">0.306</span><span class="p">,</span> <span class="nv">alpha</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">)</span>

<span class="kd">class</span> <span class="kt">WorkSpace</span><span class="p">:</span> <span class="kt">CanvasController</span> <span class="p">{</span>
   <span class="k">var</span> <span class="nv">background</span> <span class="o">=</span> <span class="kt">ParallaxBackground</span><span class="p">()</span>
   
   <span class="k">override</span> <span class="kd">func</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
       <span class="n">canvas</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="n">background</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
   <span class="p">}</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<blockquote>
  <p>The background object is a subclass of CanvasController, just like your WorkSpace, so it has a canvas (which is a view) which is why we add background.canvas</p>
</blockquote>

<p>With that done, let’s outline the steps for adding the parallax layers:</p>

<ol>
  <li>Create an array of speeds so we know how quickly to move each layer</li>
  <li>Create and add all the layers baseda on their speeds</li>
  <li>Add a context and observer for creating the parallax effect</li>
  <li>Test the scrolling with some labels</li>
</ol>

<p>This should be it for now for working in the WorkSpace, from this point onwards we’re going to be working in the ParallaxBackground file</p>

<h2 id="create-speeds-and-scrollviews-arrays">Create Speeds and Scrollviews Arrays</h2>

<p>This step is dead-easy. Create an array of <code class="highlighter-rouge">CGFloat</code> values that we’ll be using throughout the rest of our setup.</p>

<p>Add the following variable to your class:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="k">let</span> <span class="nv">speeds</span> <span class="p">:</span> <span class="p">[</span><span class="kt">CGFloat</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.08</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.10</span><span class="p">,</span><span class="mf">0.12</span><span class="p">,</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>We have simply taken the values from the design file and added them in order such that the bottom layer’s speed, <code class="highlighter-rouge">0.08</code> is the first entry (i.e. <code class="highlighter-rouge">[0]</code>) in the array, and the top layer’s speed is the last entry.</p>

<p>We label the array <code class="highlighter-rouge">: [CGFloat]</code> because we’re going to be passing these values directly to views that are subclassed from <code class="highlighter-rouge">UIScrollView</code> and it’s just a bit cleaner to not have to cast from <code class="highlighter-rouge">Double</code> when we know we’re only going to be working with <code class="highlighter-rouge">CGFloat</code> variables.</p>

<p>Finally, add a variable array of <code class="highlighter-rouge">InfiniteScrollview</code> types to your class. Later on we’re going to reference this array so we’ll add it here to be a bit ahead of the game.</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="k">var</span> <span class="nv">scrollviews</span> <span class="o">=</span> <span class="p">[</span><span class="kt">InfiniteScrollView</span><span class="p">]()</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Your class should look like this:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4</pre></td><td class="code"><pre><span class="kd">class</span> <span class="kt">ParallaxBackground</span> <span class="p">:</span> <span class="kt">CanvasController</span> <span class="p">{</span>
   <span class="k">let</span> <span class="nv">speeds</span> <span class="p">:</span> <span class="p">[</span><span class="kt">CGFloat</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.08</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.10</span><span class="p">,</span><span class="mf">0.12</span><span class="p">,</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]</span>
   <span class="k">var</span> <span class="nv">scrollviews</span> <span class="o">=</span> <span class="p">[</span><span class="kt">InfiniteScrollView</span><span class="p">]()</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h2 id="create-layers-based-on-speeds">Create Layers Based on Speeds</h2>

<p>Since we’ve already built the <code class="highlighter-rouge">InfiniteScrollView</code> class, we can start working with it right away. The easiest way to add all our layers is to create and add them individually, however this isn’t so efficient when we already know that their scroll speeds will be different.</p>

<p><img src="01.png" alt="" /></p>

<p>The previous image shows how varying speeds will actually dictate how much of a scrollview’s contents will actually be seen. Compared to the top layer which encapsulates the full width of all our app’s contents, the first layer with a speed of <code class="highlighter-rouge">0.08</code> will only need a <code class="highlighter-rouge">contentSize</code> that is 8% the width of the top layer’s size. This means that we don’t need to create full-size contents for all the layers.</p>

<h3 id="dynamic-layer-contentsize">Dynamic Layer contentSize</h3>

<p>We want to build our layers so that they reference their speeds and build themselves accordingly. And, the most forward-looking way to do this is through a method that takes the right parameters and builds a layer for us.</p>

<p>Add the following method to your class:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre><span class="kd">func</span> <span class="nf">createLayer</span><span class="p">(</span><span class="nv">speed</span><span class="p">:</span> <span class="kt">CGFloat</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">InfiniteScrollView</span> <span class="p">{</span>
   <span class="k">return</span> <span class="kt">InfiniteScrollView</span><span class="p">()</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>This is basically a skeleton method that allows us to build dynamic layers from our setup. Let’s test it out by creating our setup() to look like this:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7</pre></td><td class="code"><pre><span class="k">override</span> <span class="kd">func</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
   <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">0</span><span class="o">..&lt;</span><span class="n">speeds</span><span class="o">.</span><span class="n">count</span> <span class="p">{</span>
  <span class="k">let</span> <span class="nv">layer</span> <span class="o">=</span> <span class="nf">createLayer</span><span class="p">(</span><span class="n">speeds</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
       <span class="n">canvas</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
  <span class="n">scrollviews</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
   <span class="p">}</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>We’re adding the new layer to both the canvas and our scrollviews array. The reason for this is that a) we want to see it on screen, b) we will need to reference it later.</p>

<p>Run it.</p>

<p>We see nothing, of course because there’s no content in our things. So, let’s modify our <code class="highlighter-rouge">createLayer</code> method.</p>

<h3 id="modify-createlayer">Modify createLayer</h3>

<p>First, we know that there are going to be 12 signs, so let’s make a <code class="highlighter-rouge">let signCount</code> that we can reference.</p>

<p>Add the following to your class:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="k">let</span> <span class="nv">signCount</span> <span class="p">:</span> <span class="kt">CGFloat</span> <span class="o">=</span> <span class="mf">12.0</span> <span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<blockquote>
  <p>Again, we only need this value for laying out a UIKit object, so we specify that it’s a CGFloat.
Also, I like to keep all my variables at the top of my class so I put this one under the speeds array</p>
</blockquote>

<p>Since we’re testing our dynamic layout we can simply modify the <code class="highlighter-rouge">createLayer</code> method to add a bunch of numbers to our layers.</p>

<p>Start by grabbing the frame of our canvas view and use that to initialize a layer, like so:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5</pre></td><td class="code"><pre><span class="kd">func</span> <span class="nf">createLayer</span><span class="p">(</span><span class="nv">speed</span><span class="p">:</span> <span class="kt">CGFloat</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">InfiniteScrollView</span> <span class="p">{</span>
   <span class="k">let</span> <span class="nv">frame</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">bounds</span>
   <span class="k">let</span> <span class="nv">layer</span> <span class="o">=</span> <span class="kt">InfiniteScrollView</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="n">frame</span><span class="p">)</span>
   <span class="k">return</span> <span class="n">layer</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Instead of simply returning an <code class="highlighter-rouge">InfiniteScrollView</code>, breaking up the steps like this (i.e. making a layer then returning the layer) gives us the opportunity to modify the object before returning it.</p>

<p>Next, we’re going to modify the size of our layer’s contents:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7</pre></td><td class="code"><pre><span class="kd">func</span> <span class="nf">createLayer</span><span class="p">(</span><span class="nv">speed</span><span class="p">:</span> <span class="kt">CGFloat</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">InfiniteScrollView</span> <span class="p">{</span>
   <span class="k">let</span> <span class="nv">frame</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">bounds</span>
   <span class="k">let</span> <span class="nv">layer</span> <span class="o">=</span> <span class="kt">InfiniteScrollView</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="n">frame</span><span class="p">)</span>
   <span class="k">let</span> <span class="nv">contentSize</span> <span class="o">=</span> <span class="kt">CGSizeMake</span><span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">signCount</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
   <span class="n">layer</span><span class="o">.</span><span class="n">contentSize</span> <span class="o">=</span> <span class="n">contentSize</span>
   <span class="k">return</span> <span class="n">layer</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Now, let’s add some labels so that we can see what we’re actually putting on screen. Before we return the layer let’s add a <code class="highlighter-rouge">repeat</code> that takes the current number of elements in our <code class="highlighter-rouge">scrollviews</code> array and adds a bunch of labels for the entire content size of our layer:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8</pre></td><td class="code"><pre><span class="k">let</span> <span class="nv">dx</span> <span class="o">=</span> <span class="kt">Double</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">contentSize</span><span class="o">.</span><span class="n">width</span><span class="p">)</span> <span class="o">/</span> <span class="mf">100.0</span>
<span class="k">var</span> <span class="nv">center</span> <span class="o">=</span> <span class="kt">Point</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">canvas</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
<span class="k">repeat</span> <span class="p">{</span>
   <span class="k">let</span> <span class="nv">label</span> <span class="o">=</span> <span class="kt">TextShape</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="s">"</span><span class="se">\(</span><span class="n">scrollviews</span><span class="o">.</span><span class="n">count</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
   <span class="n">label</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>
   <span class="n">layer</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
   <span class="n">center</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="n">dx</span>
<span class="p">}</span> <span class="k">while</span> <span class="n">center</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="kt">Double</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">contentSize</span><span class="o">.</span><span class="n">width</span><span class="p">)</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>This step creates a displacement variable, <code class="highlighter-rouge">dx</code>, that will give us 20 labels based on the width of the layer’s <code class="highlighter-rouge">contentSize</code>. Then, it creates a variable center point whose <code class="highlighter-rouge">x</code> position will get modified for every label we add. Finally, it runs a <code class="highlighter-rouge">repeat</code> that loops until the center position is outside the layer’s contents. During that loop, we create a new label based on the current number of elements in the <code class="highlighter-rouge">scrollviews</code> array (so the first layer should be <code class="highlighter-rouge">0</code>).</p>

<p>And, when you run it your app should look like this:</p>

<p><img src="02.png" alt="" /></p>

<p>See how they’re all on top of one another? This is because the <code class="highlighter-rouge">contentSize</code> for each layer is identical. Let’s put the speed variable to good use now.</p>

<p>Modify the calculation of the content size to this:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="k">let</span> <span class="nv">contentSize</span> <span class="o">=</span> <span class="kt">CGSizeMake</span><span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">signCount</span> <span class="o">*</span> <span class="n">speed</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">height</span><span class="p">)</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Your whole ParallaxBackground file should look like:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></td><td class="code"><pre><span class="kd">import</span> <span class="kt">UIKit</span>

<span class="kd">class</span> <span class="kt">ParallaxBackground</span> <span class="p">:</span> <span class="kt">CanvasController</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">speeds</span> <span class="p">:</span> <span class="p">[</span><span class="kt">CGFloat</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.08</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.10</span><span class="p">,</span><span class="mf">0.12</span><span class="p">,</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]</span>
    <span class="k">var</span> <span class="nv">scrollviews</span> <span class="p">:</span> <span class="p">[</span><span class="kt">InfiniteScrollView</span><span class="p">]</span><span class="o">!</span>
    <span class="k">let</span> <span class="nv">signCount</span> <span class="p">:</span> <span class="kt">CGFloat</span> <span class="o">=</span> <span class="mf">12.0</span>
    
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">scrollviews</span> <span class="o">=</span> <span class="p">[</span><span class="kt">InfiniteScrollView</span><span class="p">]()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">0</span><span class="o">..&lt;</span><span class="n">speeds</span><span class="o">.</span><span class="n">count</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">layer</span> <span class="o">=</span> <span class="nf">createLayer</span><span class="p">(</span><span class="n">speeds</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">canvas</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
            <span class="n">scrollviews</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">createLayer</span><span class="p">(</span><span class="nv">speed</span><span class="p">:</span> <span class="kt">CGFloat</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">InfiniteScrollView</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">frame</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">bounds</span>
        <span class="k">let</span> <span class="nv">layer</span> <span class="o">=</span> <span class="kt">InfiniteScrollView</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="n">frame</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">contentSize</span> <span class="o">=</span> <span class="kt">CGSizeMake</span><span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">signCount</span> <span class="o">*</span> <span class="n">speed</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
        <span class="n">layer</span><span class="o">.</span><span class="n">contentSize</span> <span class="o">=</span> <span class="n">contentSize</span>

        <span class="k">let</span> <span class="nv">dx</span> <span class="o">=</span> <span class="kt">Double</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">contentSize</span><span class="o">.</span><span class="n">width</span><span class="p">)</span> <span class="o">/</span> <span class="mf">100.0</span>
        <span class="k">var</span> <span class="nv">center</span> <span class="o">=</span> <span class="kt">Point</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">canvas</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="k">repeat</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">label</span> <span class="o">=</span> <span class="kt">TextShape</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="s">"</span><span class="se">\(</span><span class="n">scrollviews</span><span class="o">.</span><span class="n">count</span><span class="se">)</span><span class="s">"</span><span class="p">)</span><span class="o">!</span>
            <span class="n">label</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>
            <span class="n">layer</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
            <span class="n">center</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="n">dx</span>
        <span class="p">}</span> <span class="k">while</span> <span class="n">center</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="kt">Double</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">contentSize</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">layer</span>
    <span class="p">}</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>And your app should look like</p>

<p><img src="03.png" alt="" /></p>

<p>Not pretty. So, let’s offset those labels based on the layer number and the content size:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9</pre></td><td class="code"><pre><span class="k">let</span> <span class="nv">dx</span> <span class="o">=</span> <span class="kt">Double</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">contentSize</span><span class="o">.</span><span class="n">width</span><span class="p">)</span> <span class="o">/</span> <span class="mf">100.0</span>
<span class="k">let</span> <span class="nv">dy</span> <span class="o">=</span> <span class="kt">Double</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">contentSize</span><span class="o">.</span><span class="n">height</span><span class="p">)</span> <span class="o">/</span> <span class="kt">Double</span><span class="p">(</span><span class="n">speeds</span><span class="o">.</span><span class="n">count</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="k">var</span> <span class="nv">center</span> <span class="o">=</span> <span class="kt">Point</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="kt">Double</span><span class="p">(</span><span class="n">scrollviews</span><span class="o">.</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">dy</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">fontSize</span> <span class="o">=</span> <span class="kt">Double</span><span class="p">(</span><span class="n">scrollviews</span><span class="o">.</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">6.0</span>
<span class="k">let</span> <span class="nv">font</span> <span class="o">=</span> <span class="kt">Font</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span><span class="s">"AvenirNext-DemiBold"</span><span class="p">,</span> <span class="nv">size</span><span class="p">:</span> <span class="n">fontSize</span><span class="p">)</span><span class="o">!</span>
<span class="k">repeat</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">label</span> <span class="o">=</span> <span class="kt">TextShape</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="s">"</span><span class="se">\(</span><span class="n">scrollviews</span><span class="o">.</span><span class="n">count</span><span class="se">)</span><span class="s">"</span><span class="p">,</span> <span class="nv">font</span><span class="p">:</span> <span class="n">font</span><span class="p">)</span><span class="o">!</span>
    <span class="c1">//...</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Now it’s pretty.</p>

<p><img src="04.png" alt="" /></p>

<blockquote>
  <p>See that 1 that’s strangely achored to the left? That’s because the speed for that layer is 0.0… Basically, it will be a non-moving layer, so its content size is zero.</p>
</blockquote>

<p>And, when you scroll it:</p>

<p><img src="" alt="" data-id="UnnaturalObedientKillifish" class="gfyitem" /></p>

<p>Let’s hook those other ones up.</p>

<h2 id="hookem-uuuup">Hook’em UuuuP</h2>

<p>We’ve done it before, we’re doing it again, we’re going to add a context and observer for creating the parallax effect based on the speeds of our layers.</p>

<p>First, add a new property to your class:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="k">var</span> <span class="nv">scrollviewOffsetContext</span> <span class="o">=</span> <span class="mi">0</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>This is a variable that identifies a context for observing the offset of our layers.</p>

<p>Start typing out <code class="highlighter-rouge">observeValueForKeyPath</code>, and by the time you get to the <strong>b</strong> Xcode should look like:</p>

<p><img src="05.png" alt="" /></p>

<p>Hit <code class="highlighter-rouge">return</code> to choose that method.</p>

<p>Now, where it says the word <code class="highlighter-rouge">code</code> add the following:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre><span class="k">if</span> <span class="n">context</span> <span class="o">==</span> <span class="o">&amp;</span><span class="n">scrollviewOffsetContext</span> <span class="p">{</span>
   <span class="nf">print</span><span class="p">(</span><span class="s">"top layer is scrolling"</span><span class="p">)</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Then, hook that up to our top layer by adding the following in <code class="highlighter-rouge">setup()</code>, after the for loop that creates the layers:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre><span class="k">if</span> <span class="k">let</span> <span class="nv">topLayer</span> <span class="o">=</span> <span class="n">scrollviews</span><span class="o">.</span><span class="n">last</span> <span class="p">{</span>
    <span class="n">topLayer</span><span class="o">.</span><span class="nf">addObserver</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKeyPath</span><span class="p">:</span> <span class="s">"contentOffset"</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="o">.</span><span class="kt">New</span><span class="p">,</span> <span class="nv">context</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">scrollviewOffsetContext</span><span class="p">)</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Your class should basically look like this:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></td><td class="code"><pre><span class="kd">class</span> <span class="kt">ParallaxBackground</span> <span class="p">:</span> <span class="kt">CanvasController</span> <span class="p">{</span>
   <span class="k">var</span> <span class="nv">speeds</span> <span class="o">...</span>
   <span class="k">var</span> <span class="nv">scrollviews</span> <span class="o">...</span>
   <span class="k">let</span> <span class="nv">signCount</span> <span class="o">...</span>
    
   <span class="k">var</span> <span class="nv">scrollviewOffsetContext</span> <span class="o">=</span> <span class="mi">0</span>
    
   <span class="k">override</span> <span class="kd">func</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
       <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">0</span><span class="o">..&lt;</span><span class="n">speeds</span><span class="o">.</span><span class="n">count</span> <span class="p">{</span>
      <span class="o">...</span>
       <span class="p">}</span>   
       <span class="k">if</span> <span class="k">let</span> <span class="nv">topLayer</span> <span class="o">=</span> <span class="n">scrollviews</span><span class="o">.</span><span class="n">last</span> <span class="p">{</span>
           <span class="n">topLayer</span><span class="o">.</span><span class="nf">addObserver</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKeyPath</span><span class="p">:</span> <span class="s">"contentOffset"</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="o">.</span><span class="kt">New</span><span class="p">,</span> <span class="nv">context</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">scrollviewOffsetContext</span><span class="p">)</span>
       <span class="p">}</span>
   <span class="p">}</span>
    
   <span class="kd">func</span> <span class="nf">createLayer</span><span class="p">(</span><span class="nv">speed</span><span class="p">:</span> <span class="kt">CGFloat</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">InfiniteScrollView</span> <span class="p">{</span>
   <span class="p">}</span>

   <span class="k">override</span> <span class="kd">func</span> <span class="nf">observeValueForKeyPath</span><span class="p">(</span><span class="nv">keyPath</span><span class="p">:</span> <span class="kt">String</span><span class="p">?,</span> <span class="n">ofObject</span> <span class="nv">object</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">?,</span> <span class="nv">change</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span> <span class="p">:</span> <span class="kt">AnyObject</span><span class="p">]?,</span> <span class="nv">context</span><span class="p">:</span> <span class="kt">UnsafeMutablePointer</span><span class="o">&lt;</span><span class="kt">Void</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">if</span> <span class="n">context</span> <span class="o">==</span> <span class="o">&amp;</span><span class="n">scrollviewOffsetContext</span> <span class="p">{</span>
           <span class="nf">print</span><span class="p">(</span><span class="s">"top layer is scrolling"</span><span class="p">)</span>
       <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Run it. Scroll it and the Xcode console should be spitting out a bunch of stuff…</p>

<p><img src="" alt="" data-id="QualifiedSpitefulBluebird" class="gfyitem" /></p>

<p>Now, let’s modify the guts of our observe method to hook up the rest of the layers.</p>

<p>Replace:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="nf">print</span><span class="p">(</span><span class="s">"top layer is scrolling"</span><span class="p">)</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>With:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7</pre></td><td class="code"><pre><span class="k">let</span> <span class="nv">sv</span> <span class="o">=</span> <span class="n">object</span> <span class="k">as!</span> <span class="kt">InfiniteScrollView</span>
<span class="k">let</span> <span class="nv">offset</span> <span class="o">=</span> <span class="n">sv</span><span class="o">.</span><span class="n">contentOffset</span>

<span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">0</span><span class="o">..&lt;</span><span class="n">scrollviews</span><span class="o">.</span><span class="n">count</span><span class="o">-</span><span class="mi">1</span> <span class="p">{</span>
   <span class="k">let</span> <span class="nv">layer</span> <span class="o">=</span> <span class="n">scrollviews</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
   <span class="n">layer</span><span class="o">.</span><span class="n">contentOffset</span> <span class="o">=</span> <span class="kt">CGPointMake</span><span class="p">(</span><span class="n">offset</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">speeds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>This bit of code grabs the object that is being observed, casts it to an <code class="highlighter-rouge">InfiniteScrollview</code> (we can do this with a <code class="highlighter-rouge">!</code> because we know that we added the observer to this kind of object). Then, we grab the offset and use that to help calculate the rest of the offsets for the other layers.</p>

<p>Finally, we create a loop that runs through all the layers and adjusts their <code class="highlighter-rouge">contentOffset</code> based on the layer’s speed. the top layer’s current offset value.</p>

<p>Now we get this:</p>

<p><img src="" alt="" data-id="UltimateWellmadeAnkole" class="gfyitem" /></p>

<p>There’s a bug in our logic. Why? It seems like we’re doing the right thing, right? We’re basically saying: “If the speed is 80% of the main layer’s speed, then we only need to see a canvas that is 80% of the width.” Which is totally true.</p>

<p>But, when the main layer is scrolled far enough the end of the smaller 80% canvas will be “on” the screen. At this point the view will stop scrolling because a view will only scroll if there is content hanging off of the end of its frame.</p>

<p><img src="06.png" alt="We need to extend each canvas by 20%" /></p>

<p>Basically, a canvas that is 80% of the main canvas will only scroll until <strong>80% - visibleFrameWidth</strong>. So, we need to add the width of the frame to anything that is less than 1.0 speed.</p>

<p>To fix this bug we need to go back into the <code class="highlighter-rouge">createLayer()</code> method and add a condition between creating the content size and setting that value to the layer:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre><span class="k">let</span> <span class="nv">contentSize</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">contentSize</span><span class="o">.</span><span class="n">width</span> <span class="o">+=</span> <span class="n">speed</span> <span class="o">&lt;</span> <span class="mf">1.0</span> <span class="p">?</span> <span class="n">view</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="nv">width</span> <span class="p">:</span> <span class="mi">0</span>
<span class="n">layer</span><span class="o">.</span><span class="n">contentSize</span> <span class="o">=</span> <span class="n">contentSize</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<blockquote>
  <p>Make sure you change the <code class="highlighter-rouge">let contentSize = ...</code> to a var</p>
</blockquote>

<p>We’re using a nice shorthand trick here that allows us to conditionally set a variable in a single line of code.</p>

<p>This:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="n">speed</span> <span class="o">&lt;</span> <span class="mf">1.0</span> <span class="p">?</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Basically means: “Is the speed less than one?”</p>

<p>And this:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="n">view</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="nv">width</span> <span class="p">:</span> <span class="mi">0</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Is the answer to the question where if the answer is <code class="highlighter-rouge">true</code> then we return <code class="highlighter-rouge">view.frame.width</code> otherwise <code class="highlighter-rouge">0</code>.</p>

<p>Now, this is lovely. Everything scrolls the way we expect it to, like so:</p>

<p><img src="" alt="" data-id="EasyFemaleHarvestmen" class="gfyitem" /></p>

<p>Here’s a copy of the <a href="https://gist.github.com/C4Framework/f670e2fb15450514b776">ParallaxBackground.swift</a> file.</p>

<h2 id="recap">Recap</h2>

<p>This is how I first tested the parallax effect, to see how the various speeds would affect the content / scrolling / etc. And it did its job well: we know how the content of each layer will scroll and that all the layers will respond to the top’s movement.</p>

<p>Even though this approach works, we’re going to be taking another approach in building the app, but we’ll see how that differs when we get into the next few chapters.</p>

<p>For now, you can delete this entire class from your project if you want, we won’t use it anymore.</p>

<p>Andiamo!</p>

        </div>
      </div>
    </div>

    <div class="container">
      <div class="row chapter-nav">
        <div class="col-xs-12 col-sm-12 col-md-12">
          <h1 class="text-center blue">Well done! Continue COSMOS?</h1>
          <ul class="examples-list next-prev list-unstyled">
            
              <li class="pull-left">
                <a class="more" href="/cosmos/8-Stars" title="Earlier article: Stars">
                  <div>
                    <span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span>
                    <span class="img">
                      <img src="/images/cosmos/8/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 8<br />Stars</p>
                      <p>Start bringing the COSMOS to life with some nice visual work.</p>
                    </div>
                  </div>
                </a>
              </li>
            
            
              <li class="pull-right">
                <a class="more" href="/cosmos/10-Stars-Background" title="Later article: Stars Background">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/10/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 10<br />Stars Background</p>
                      <p>Time to stargaze – we're going to build some constellations.</p>
                    </div>
                    <span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>
                  </div>
                </a>
              </li>
            
          </ul>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="row related">
        <div class="col-xs-12 col-md-12">
          <h1 class="text-center blue">All COSMOS Chapters</h1>
          <ul class="examples-list list-unstyled">
            
            
              <li>
                <a href="/cosmos/0-getting-started">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/0/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 0<br />Getting Started</p>
                      <p>Get up and running quickly with the COSMOS Xcode project files.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/1-prelude-to-design">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/1/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 1<br />Prelude To Design</p>
                      <p>An overview explaining why & how we chose to create COSMOS in the first place.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/2-designing-the-cosmos">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/2/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 2<br />Designing the COSMOS</p>
                      <p>Where to start? Defining the visual concept and deciding the functionality.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/3-plan-it">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/3/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 3<br />Plan It!</p>
                      <p>Get your goggles on as we start diving into the code with C4.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/4-Infinite-Scrollview">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/4/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 4<br />Infinite Scrollview</p>
                      <p>Implementing the idea of an infinite scrollview that loops around rather than stopping at the end.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/5-Infinite-Scrollview-Build">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/5/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 5<br />Infinite Scrollview</p>
                      <p>Time to code – get that infinite scrollview looping.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/6-Astrological-Sign-Provider">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/6/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 6<br />Astrological Sign Provider</p>
                      <p>How to go about wrangling all the data for the 12 astrological signs.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/7-Astrological-Sign-Provider-Build">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/7/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 7<br />Astrological Sign Provider - Build it!</p>
                      <p>We've wrangled all that data, now let's do something with it.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/8-Stars">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/8/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 8<br />Stars</p>
                      <p>Start bringing the COSMOS to life with some nice visual work.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/9-Parallax-Testing">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/9/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 9<br />Parallax Testing (Optional)</p>
                      <p>This optional chapter will walk you through how I originally tested the background.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/10-Stars-Background">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/10/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 10<br />Stars Background</p>
                      <p>Time to stargaze – we're going to build some constellations.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/11-Sign-Lines">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/11/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 11<br />Sign Lines</p>
                      <p>Time to stargaze – we're going to build some constellations.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/12-Small-Stars">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/12/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 12<br />Small Stars</p>
                      <p>Bring those constellations to life with stars. We're starting small.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/13-Big-Stars">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/13/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 13<br />Big Stars</p>
                      <p>We've got the small constellation stars, let's keep going with the big ones.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/14-Assembling-The-Stars">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/14/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 14<br />Assembling the Stars</p>
                      <p>Small stars, meet big stars. Time to unite them all.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/15-Radial-Menu">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/15/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 15<br />Radial Menu</p>
                      <p>Building the heart of the app - a radial menu with embedded animation that reacts to different gestures.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/16-Menu-Rings">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/16/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 16<br />Menu Rings</p>
                      <p>It's time to build the backbone of our radial menu.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/17-Menu-Rings">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/17/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 17<br />Animating the Menu Rings</p>
                      <p>Time to bring the radial menu to life with embedded animation.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/18-Menu-Icons">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/18/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 18<br />Menu Icons</p>
                      <p>Time to flesh out the radial menu with some animated icons.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/19-Menu-Selector">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/19/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 19<br />Menu Selector</p>
                      <p>Give the radial menu interaction and responsiveness with some programming wizardry.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/20-Menu-Shadow">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/20/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 20<br />Menu Shadow</p>
                      <p>Give a little visual pop to the radial menu with a simple shadow.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/21-Menu-Pull-It-Together">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/21/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 21<br />The Menu – Pull it Together</p>
                      <p>We've got all the components, let's get this beast put together now.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/22-Info-Panel">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/22/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 22<br />Info Panel</p>
                      <p>A straightforward info panel with push controllers, popups and external links.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/23-Pulling-It-All-Together">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/23/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 23<br />Pulling It All Together</p>
                      <p>Time to weave all the components into a unified app.</p>
                    </div>
                  </div>
                </a>
              </li>
            
              <li>
                <a href="/cosmos/24-Pulling-It-All-Together">
                  <div>
                    <span class="img">
                      <img src="/images/cosmos/24/poster.png" />
                    </span>
                    <div class="text">
                      <p class="title">Chapter 24<br />Submitting to App Store</p>
                      <p>Our last task is to get COSMOS on the App Store. Seriously.</p>
                    </div>
                  </div>
                </a>
              </li>
            
          </ul>
        </div>
      </div>
    </div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-md-3 col-sm-3 col-xs-6">
        <ul class="list-unstyled">
          <li class="title"><a href="/#overview">About</a></li>
          <li><a href="/#overview">Features</a></li>
          <!-- <li><a href="/about#history">History</a></li> -->
          <!-- <li><a href="/about/contributors">Contributors</a></li> -->
        </ul>
      </div>
      <div class="col-md-3 col-sm-3 col-xs-6">
        <ul class="list-unstyled">
          <li class="title"><a href="/learn">Learn + Explore</a></li>
          <li><a href="/install">Install C4</a></li>
          <li><a href="/examples">Examples</a></li>
          <li><a href="/tutorials">Tutorials</a></li>
          <li><a href="http://cocoadocs.org/docsets/C4/1.1.0/">Docs</a></li>
        </ul>
      </div>
      <div class="col-md-3 col-sm-3 col-xs-6">
        <ul class="list-unstyled">
          <li class="title"><a href="/contact">Connect</a></li>
          <li><a href="http://discourse.c4ios.com">Forums</a></li>
          <li><a href="http://www.medium.com/@c4framework" target="_blank">Medium</a></li>
          <li><a href="http://www.twitter.com/c4framework" target="_blank">Twitter</a></li>
          <li><a href="https://join-c4.herokuapp.com/" target="_blank">Slack</a></li>
          <li><a href="https://vimeo.com/c4ios" target="_blank">Vimeo</a></li>
          <li><a href="http://github.com/c4framework" target="_blank">GitHub</a></li>
        </ul>
      </div>
      <div class="col-md-3 col-sm-3 col-xs-6">
        <ul class="list-unstyled">
          <!-- <li class="title"><a href="/about">Sign Up for Newsletter</a></li>
          <li><input type="text" placeholder="Enter Email + Press Enter"></li> -->
          <li>© 2016 C4</li>
          <li><a href="/terms">Terms of Use</a></li>
          <li><a href="mailto:info@c4ios.com">Contact</a></li>
        </ul>    
      </div>
    </div>
  </div>
</footer>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-18444113-4', 'auto');
  ga('send', 'pageview');
</script>


    <script type="text/javascript" src="/js/toc.js"></script>
    <script>
     (function(d, t) {
        var g = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        g.src = 'http://assets.gfycat.com/js/gfyajax-0.517d.js';
        s.parentNode.insertBefore(g, s);
      }(document, 'script'));
    </script>
    <script type="text/javascript">
      $(document).ready(function() {
        $('#toc').width($('#toc').parents().width());

        $('#toc').toc({
          elementClass: 'toc',
          ulClass: 'nav',
          heading: 'Contents',
          indexingFormats: 'number',
          selector: 'h2, h3, h4',
        });

        $('body').scrollspy({
          target: '#toc',
          offset: $('#headerNav').outerHeight(true)
        });

        setTimeout(function() {
          var $sideBar = $('#toc');
          $sideBar.affix({
            offset: {
              top: function() {
                var offsetTop      = $sideBar.offset().top,
                sideBarMargin  = parseInt($sideBar.children(0).css('margin-top'), 10),
                navOuterHeight = $('#headerNav').height();
                return (this.top = offsetTop - navOuterHeight - sideBarMargin);
              },
              bottom: function() {
                return (this.bottom = $('footer').outerHeight(true) + $('.chapter-nav').outerHeight(true) + $('.related').outerHeight(true) + 60);
              }
            }
          });
        }, 100);

        $('td.gutter').each(function(index)
        {
          $(this).parents('.language-swift').closest('pre').addClass('has-gutter');
        });

        $('.tutorial img').each(function()
        {
          console.log($(this).parent());
          var img = $(this).attr('src');
          $(this).attr('src', '/images/cosmos/9/' + img + '').addClass('img-responsive');
        });

        $('.tutorial p img').unwrap().wrap('<figure></figure>').after(function() {
            return '<figcaption>'+this.alt+'</figcaption>';
        });

        $('.footnotes').prepend('<h4>Footnotes</h4>');
      });
    </script>
  </body>
</html>